<html lang="en">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Example Widget</title>
    <style>
      body {
        font-size: 16px;
        font-family: "Segoe UI", Helvetica, Arial, sans-serif;
        padding: 10px;
      }
      #widget-container > * {
        margin: 10px 2px;
      }
      #input-field {
        width: 60vw;
        padding: 5px;
      }
      #submit-button {
        padding: 5px;
      }
    </style>
  </head>

  <body>
    <div id="widget-container">
      <div id="widget-input-data">Loading...</div>
      <input id="input-field">
      <button id="submit-button">Submit</button>
      <div id="submit-message"></div>
    </div>
    
    <script>
      import AdaWidgetSDK from "@ada-support/ada-widget-sdk";

const widgetSDK = new AdaWidgetSDK();

const containerElement = document.getElementById("widget-container");
const sdkInputElement = document.getElementById("widget-input-data");
const inputElement = document.getElementById("input-field");
const submitButtonElement = document.getElementById("submit-button");
const submitMessageElement = document.getElementById("submit-message");

const handleWidgetEnd = () => {
  widgetSDK.sendUserData({
    responseData: inputElement.value
  }, (event) => {
    if (event.type === "SEND_USER_DATA_SUCCESS") {
      submitMessageElement.innerText = "Data was successfully submitted. The widget will close in a moment.";
      submitButtonElement.disabled = true;
    } else {
      submitMessageElement.innerText = "Data submission failed, please try again.";
    }
  });
  setTimeout(() => {
    widgetSDK.setWidgetClose();
  }, 2.5 * 1000);
}

submitButtonElement.onclick = handleWidgetEnd;

widgetSDK.init((event) => {
  widgetSDK.setContainerHeight(600);
  
  if (!widgetSDK.widgetIsActive) {
    containerElement.innerHTML = "The widget is not active";
    handleWidgetEnd();
    return;
  }

  const { widgetInputs } = event;
  console.log(widgetInputs);

  sdkInputElement.innerHTML = widgetInputs.inputData;
});
    </script>
    
  </body>

</html>
